# 🚀 HIT项目前端开发快速检查清单

## ⚡ 5分钟快速检查

### 1️⃣ ID类型检查 (最重要！)

```typescript
// ❌ 绝对禁止
const id = Number(route.params.id);
projectId?: number;
function getProject(id: number)

// ✅ 必须使用
const id = route.params.id as string;
projectId?: string;
function getProject(id: string)
```

### 2️⃣ 用户信息检查

```typescript
// ❌ 绝对禁止硬编码
const userId = 1;
if (userId === 1) {
  /* 管理员 */
}

// ✅ 必须使用动态获取
const userId = userStore.userId;
if (userStore.roles.includes('SUPER_ADMIN')) {
  /* 管理员 */
}
```

### 3️⃣ 路由参数检查

```typescript
// ✅ 标准模板
const route = useRoute();
const entityId = route.params.id as string;

onMounted(() => {
  if (!entityId) {
    ElMessage.error('参数无效');
    router.back();
    return;
  }
  loadData();
});
```

### 4️⃣ API调用检查

```typescript
// ✅ 标准错误处理模板
const loadData = async () => {
  loading.value = true;
  try {
    const response = await getEntityData(entityId);
    if (response.code === 200) {
      data.value = response.data;
    } else {
      ElMessage.error(response.msg || '获取数据失败');
    }
  } catch (error) {
    console.error('获取数据失败:', error);
    ElMessage.error('获取数据失败，请重试');
  } finally {
    loading.value = false;
  }
};
```

---

## 📋 提交前必查清单

### TypeScript & 类型

- [ ] 所有ID字段使用 `string` 类型
- [ ] 路由参数使用 `as string` 断言
- [ ] 没有使用 `Number()` 转换ID
- [ ] TypeScript编译无错误

### 用户信息 & 权限

- [ ] 使用 `userStore.userId` 获取用户ID
- [ ] 没有硬编码用户ID (如: `userId = 1`)
- [ ] 权限判断使用角色而非固定ID
- [ ] 添加用户登录状态检查

### 错误处理 & 用户体验

- [ ] 所有API调用有try-catch
- [ ] 异步操作有loading状态
- [ ] 错误时有用户友好提示
- [ ] 路由参数验证

### API接口

- [ ] 接口定义中ID为 `string` 类型
- [ ] 函数参数ID为 `string` 类型
- [ ] 删除操作使用 `string[]` 数组

---

## 🔧 新建模块快速模板

### API接口模板

```typescript
// src/api/hit/[moduleName].ts
export interface [ModuleName]Info {
  [moduleName]Id?: string;  // ⚠️ 必须string
  // 其他字段...
}

export function get[ModuleName](id: string): AxiosPromise<[ModuleName]Info> {
  return request({
    url: `/hit/[moduleName]/${id}`,
    method: 'get'
  });
}
```

### 页面组件模板

```vue
<!-- src/views/hit/[moduleName]/index.vue -->
<script setup lang="ts">
import { useRouter, useRoute } from 'vue-router';
import { useUserStore } from '@/store/modules/user';

const router = useRouter();
const route = useRoute();
const userStore = useUserStore();

// ⚠️ 关键：ID获取
const entityId = route.params.id as string;

// ⚠️ 关键：参数验证
onMounted(() => {
  if (!entityId) {
    ElMessage.error('参数无效');
    router.back();
    return;
  }
  loadData();
});
</script>
```

---

## 🚨 常见错误提醒

### 绝对不能出现的代码

```typescript
❌ Number(route.params.id)
❌ parseInt(userId)
❌ const userId = 1
❌ projectId?: number
❌ if (userId === 1)
❌ 没有try-catch的API调用
❌ 没有loading状态的异步操作
```

### 必须出现的代码

```typescript
✅ route.params.id as string
✅ userStore.userId
✅ projectId?: string
✅ userStore.roles.includes('ADMIN')
✅ try-catch包装的API调用
✅ loading状态管理
```

---

## 📞 遇到问题时

1. **ID类型问题** → 检查是否使用了Number()转换
2. **精度丢失** → 确认所有ID都是string类型
3. **权限问题** → 检查是否硬编码了用户ID
4. **路由错误** → 检查参数获取和验证
5. **API错误** → 检查错误处理和类型定义

**记住：ID永远是string，用户信息永远从store获取！**

---

_💡 建议：将此清单保存为书签，每次开发新功能时都检查一遍！_
